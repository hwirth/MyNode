<script>
setTimeout( ()=>location.reload(), 5000 );
const target = {
	p1: {
		p11: { p111: 111, p112: 112 },
		p12: { p121: 121, p122: 122 },
	},
	p2: {
		p21: { p211: 211, p212: 212 },
		p22: { p221: 221, p222: 222 },
	},
};
function property (target, path, value) {
	const can_set = ['boolean','number','string'];
	const set_value = (typeof value != 'undefined');
	if (!path) path = '';
	return walk( target, path.split('.'), 'object' );
	function walk (target, path, traversed) {
		if (path.length == 0) return target;
		const key = path[0];
		if (typeof target[key] == 'undefined') {
			throw new Error( 'Property not found: ' + traversed + '.' + key );
		}
		if (set_value && (path.length == 1)) {
			const type = typeof target[key];
			if (can_set.indexOf(type) < 0) {
				throw new Error( traversed + '.' + key + ' is ' + type );
			}
			return target[key] = value;
		}
		return walk( target[key], path.slice(1), traversed + '.' + key );
	}
}
const r1 = property( target, 'p2.p21.p211', '333' );
//console.log( 'set:', JSON.stringify(r1, null, '\t') );
//console.log( JSON.stringify(target, null, '\t') );
const r2 = property( target, 'p2.p21.p211' );
console.log( 'get:', JSON.stringify(r2, null, '\t') );
//console.log( JSON.stringify(target, null, '\t') );
</script>
